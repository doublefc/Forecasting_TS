# Forecating_TS
Прогнозирование подневных данных объема расчетных счетов физических лиц в Сбер банке.

Для начала стоило построить простую модель на основе аддитивной и мультипликативной модели в качестве бейз лайна. Данные про постороение этой модели можно увидеть в файле baseline.ipynb
Baseline относительно неплохо приближал временной ряд, однако MAPE- средний абсолютные процентные ошибки получились довольно высокими, поэтому для предсказания их использовать не стоило.

В качестве основной модели была выбрана SARIMA модель. Эта модель в отличие от ARIMA учитывается сезонную компоненту, которая явно наблюдается в данных. 
Как известно, для моделей типо ARIMA, в нашем случае SARIMA необходимо привести ряд к стационарному виду, например первой разностью. По тесту Дики Фулера удалось установить, 
что первой разности для приведения ряда к стационарному виду достаточно. Далее необходимо было построить pacf и acf - графики, на основе которых следует определять главные гиперпараметры модели SARIMA. 
Я не стал  определять эти гиперпараметры "на глаз" из-за неоднозначности графиков. В дальнейшем эти гиперпараметры будут подбираться с помощью optuna.

Линейная реализация модели SARIMA показала себя не очень хорошо из-за отсутствия сильных колебаний моделей в течение 28 дней. Эта модель скорее отражала кумулятивное среднее. Поэтому линейный вариант модели стоило использовать также в виде бейзлайна.

Реализация модели на основе градиентного бустинга показаал себя лучше всего. Эта модель смогла предсказать колебания в течение 28 дней и на тестовой выборке показала себя довольно хорошо. Поэтому она и была взята как основная модель. Гиперпараметры для град. бустинга, как и показатели p,q,P,Q подбирались с помощью optuna.
Предсказания градиентного бустинга на тестовой выборке:
![Безымянный](https://github.com/doublefc/Forecating_TS/assets/108407596/8efd7589-d7bd-4211-9817-ca5446665cd1)

По итогу:
mape для лин. модели - 6%
для град. бустинга - 5%

Однако град. бустинг предсказывал колебания в течение периода, равному 28 дней, что может быть важно для работы банка.
